<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Who Does What ‚Äì Finance PD | DeSoto ISD</title>
  <style>
    /* 1. Variables and Base Reset */
    :root{
      /* DeSoto ISD vibe */
      --green: #0B6E4F; /* primary */
      --green-600: #0f8b64;
      --gold: #F7B500;  /* accent */
      --ink: #0f172a;
      --slate: #334155;
      --bg: #f7faf7;
      --card: #ffffff;
      --ring: rgba(11,110,79,.2);
      --red: #c2410c;
    }
    *, *::before, *::after { box-sizing: border-box; }
    html, body { margin: 0; }
    body{ font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji"; line-height: 1.45; background: var(--bg); color: var(--ink); }
    a{ color: var(--green); text-decoration: none; }
    a:hover{ text-decoration: underline; }

    /* 2. Layout and Header */
    .wrap{ max-width: 1100px; margin: auto; padding: 24px; }
    header{ background: linear-gradient(120deg, var(--green) 0%, #074a36 65%); color: #fff; padding: 28px 24px; border-bottom: 6px solid var(--gold); }
    header .wrap{ padding: 0; }
    h1{ margin: 0 0 6px 0; font-size: clamp(1.6rem, 1.1rem + 2vw, 2.2rem); letter-spacing: .2px; }
    .subtitle{ opacity: .95; max-width: 850px; }
    .toolbar{ display: flex; gap: 12px; align-items: center; flex-wrap: wrap; margin: 18px 0 6px; }
    .badge{ display: inline-flex; align-items: center; gap: 6px; padding: 6px 10px; border-radius: 999px; background: #e6f4ee; color: #064d38; border: 1px solid var(--ring); font-weight: 600; }

    /* 3. Filter Bar (Sticky Upgrade) */
    .searchbar{
      display: flex; gap: 10px; margin: 18px 0;
      position: sticky; /* Make it sticky */
      top: -1px; /* Just below the top edge */
      background: var(--bg);
      padding: 10px 0 18px; /* Padding for separation */
      z-index: 10;
      box-shadow: 0 2px 5px -3px rgba(0,0,0,.1); /* Subtle float effect */
    }
    .searchbar input, .searchbar select{ padding: 10px 12px; border-radius: 10px; border: 1px solid #d1e7dd; background: var(--card); outline: none; flex-grow: 1; }
    .searchbar select { flex-grow: 0; }
    .searchbar input:focus{ border-color: var(--green); box-shadow: 0 0 0 3px var(--ring); }
    .btn{ display: inline-flex; align-items: center; gap: 8px; background: var(--green); color: #fff; border: none; border-radius: 999px; padding: 10px 14px; cursor: pointer; font-weight: 700; flex-shrink: 0; }
    .btn:hover{ background: var(--green-600); }

    /* 4. Scenario Grid and Cards */
    .grid{ display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 16px; margin-top: 18px; }
    .card{ background: var(--card); border: 1px solid #e5efe9; border-radius: 16px; padding: 14px; box-shadow: 0 1px 2px rgba(0,0,0,.03); transition: transform 0.2s; }
    .card[data-filtered="true"] { transform: scale(1.02); box-shadow: 0 4px 8px rgba(0,0,0,.08); } /* Visual cue for filtering */
    .card h3{ margin: 2px 0 8px; font-size: 1.05rem; cursor: pointer; } /* Make card headers clickable */
    .owner{ font-size: .9rem; color: var(--slate); }
    .io{ display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 10px; }
    details{ border: 1px dashed #e2e8f0; border-radius: 12px; padding: 10px 12px; background: #fcfffd; }
    summary{ cursor: pointer; font-weight: 700; }
    .do{ border-left: 4px solid var(--green); padding-left: 10px; }
    .dont{ border-left: 4px solid var(--red); padding-left: 10px; }
    .muted{ color: #64748b; font-size: .9rem; }
    .highlight{ background-color: var(--gold); padding: 1px 0; border-radius: 2px; } /* Search highlighting */

    /* 5. Flow Rail */
    .flow{ margin: 28px 0; background: var(--card); border: 1px solid #e5efe9; border-radius: 16px; padding: 14px; }
    .flow h2{ margin: 0 0 8px; }
    .flow-rail{
      display: flex; /* Upgraded to Flexbox for better responsiveness */
      gap: 8px;
      align-items: center;
      justify-content: space-between;
      overflow-x: auto; /* Allow scrolling if too many steps */
      padding-bottom: 5px;
    }
    .step{
      flex: 1 1 120px; /* Allow steps to grow/shrink, with a minimum width */
      border: 1px dashed #d1e7dd; background: #fbfefc; padding: 12px; border-radius: 12px; text-align: center;
      cursor: pointer; transition: background 0.2s;
    }
    .step:hover{ background: #eef8f4; }
    .step strong{ display: block; color: var(--green); margin-bottom: 4px; }
    .arrow{ font-size: 20px; color: #64748b; flex-shrink: 0; }

    /* 6. Utility and Footer */
    .resources{ margin: 26px 0; }
    .footer{ margin: 38px 0 10px; color: #475569; font-size: .9rem; }
    .sr-only{ position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Quick ‚ÄúWho Does What‚Äù in Finance PD</h1>
      <p class="subtitle">Fast lane guide for routing requests: who handles it, what you should do, and what to avoid. Built for speed, clarity, and fewer wild goose chases.</p>
      <div class="toolbar">
        <span class="badge">üîé Fast filter for scenarios</span>
        <span class="badge">‚ö° Lightweight ‚Ä¢ drop‚Äëin</span>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section aria-labelledby="filter">
      <h2 id="filter" class="sr-only">Filter and Search</h2>
      <div class="searchbar">
        <input id="q" type="search" placeholder="Search scenarios, e.g., ‚Äònegative budget‚Äô or ‚Äòstipend missing‚Äô" aria-label="Search" />
        <select id="lane" aria-label="Choose functional area">
          <option value="">All areas</option>
          </select>
        <button class="btn" id="clear">Clear</button>
      </div>
    </section>

    <section class="flow" aria-labelledby="flow">
      <h2 id="flow">Clickable Routing Flow</h2>
      <div class="flow-rail" id="flow-rail" role="list">
        </div>
    </section>

    <section aria-labelledby="lanes">
      <h2 id="lanes" class="sr-only">Functional Areas and Scenarios</h2>
      <div class="grid" id="cards"></div>
    </section>

    <section class="resources" aria-labelledby="resources">
      <h2 id="resources">Helpful References</h2>
      <ul>
        <li><a href="https://tea.texas.gov/finance-and-grants/state-funding/state-funding-manuals/school-finance-topics-one-page-descriptions" target="_blank" rel="noopener">TEA ‚Äì School Finance Topics (one‚Äëpagers)</a></li>
        <li><a href="https://www.tasbo.org/tools-services" target="_blank" rel="noopener">TASBO ‚Äì Tools & Services</a></li>
      </ul>
    </section>

    <p class="footer">Maintainer: Grants/Special Revenue ‚Ä¢ Last updated <span id="asof"></span></p>
  </main>

  <script>
    // --- Data Model ---
    const owners = {
      "Budget": { owner: "Bessye", contact: "bessye.adams@desotoisd.org" },
      "Payroll": { owner: "Ana", contact: "ana@example.org" },
      "Purchasing / AP": { owner: "Saundra", contact: "saundra@example.org" },
      "Procurement": { owner: "Michael", contact: "michael@example.org" },
      "Grants / Special Revenue": { owner: "Elizabeth", contact: "elizabeth.bostic@desotoisd.org" },
      "Cash Handling / Audit": { owner: "Ron", contact: "ron@example.org" }
    };

    const scenarios = [
      {
        lane: "Budget",
        title: "Negative balance with 2 weeks left in month",
        when: "Your budget line shows a negative or near‚Äëzero balance before month end.",
        do: "Submit a budget amendment request to Budget; include account string, justification, and projected needs.",
        dont: "Do not ‚Äòpark‚Äô costs on a random line or move charges without documented approval.",
        tags: ["amendment", "account", "fund", "balance"],
        links: []
      },
      {
        lane: "Payroll",
        title: "Stipend missing from paycheck",
        when: "An approved stipend didn‚Äôt show on the latest payroll.",
        do: "Open a ticket with Payroll including employee ID, stipend form, pay period, and approver.",
        dont: "Don‚Äôt ask AP to cut a manual check; routing must go through Payroll.",
        tags: ["check", "timecard", "direct deposit"],
        links: []
      },
      {
        lane: "Purchasing / AP",
        title: "Vendor asks about unpaid invoice",
        when: "A vendor reports an invoice is past due.",
        do: "Verify PO match and receiving in the system; send AP the PO, invoice, and receipt confirmation.",
        dont: "Don‚Äôt email only the invoice without the PO and receipt‚Äîit delays processing.",
        tags: ["payment", "billing", "receiving", "po"],
        links: []
      },
      {
        lane: "Procurement",
        title: "Need to purchase > $10,000",
        when: "Planned purchase exceeds local/board threshold.",
        do: "Consult Procurement for quotes/bid requirements and timeline; attach
